# 10. 클라우드 MySQL
- 클라우드에서 성능은 곧 돈임
- 클라우드가 아닌 MySQL에 집중할 수 있도록 클라우드 고려사항을 알고 완화하는 것이 목표
## 10.1 호환성
- MySQL의 호환성에는 코드 호환성과 기능 호환성이 존재
##### 코드 호환성
- MySQL이 오라클, percona, MariaDB에서 게시한 동일한 오프소스 코드인지 여부
- 다음 9개 단어와 문구는 MySQL이 코드 호환성이 없지만, 약간 다른다는 사실을 암시
  - 내장
  - 모방
  - 호환성
  - 클라이언트 호환성
  - 프로토콜 호환성
  - 유선 호환성
  - 대체
  - 순간 교체
  - 기존 작업
- MySQL은 복잡하고 미묘하기 때문에 코드 호환성이 중요하며, 귀중한 데이터를 저장하도록 위임
  - MySQL 소스 코드를 변경하면 데이터 손실, 성능 저하, 버그, 비호환성 등 4가지 위험이 있음
##### 기능 호환성
- MySQL이 클라우드 공급자나 MySQL 배포판 외부에서 사용할 수 없는 기능을 포함하는지 여부
- 더 많은 기능을 제공하지만 배포판으로 직접 마이그레이션할 수 없음을 의미
- 기능 호환성은 `변경의 자유`처럼 중요함 -> 특정 공급 업체에 얽메이지 않음
- 만약 사용하게 된다면 해당 부분에 대해 문서화 필수
## 10.2 관리(DBA)

| 작업              | 여러분 | 클라우드    |
|-----------------|-----|---------|
| 프로비저닝: 자원 할당    |     | V       |
| 설정              |     | V       |
| MySQL 사용자       |  V   |         |
| 서버 메트릭          |  V   |         |
| 쿼리 메트릭          |  V   |         |
| 온라인 스키마 변경(OSC) |  V   |         |
| 실패 복구           |     | V       |
| 재해 복구(DR)       |  V   |         |
| 고가용성(HA)        |   V  | (일부 관리) |
| 업그레이드           |     | V       |
| 백업 그리고 복구       |     | V       |
| 변경 데이터 캡처(CDC)  | V    |         |
| 보안              | V    |         |
| 도움              | V    |         |
| 비용              | V   |         |
- 위에 표는 MySQL 관리의 공백을 피하기 위해 작성된 것
- 클라우드 공급자는 실패 복구 처리를 하지만 재해 복구 처리를 하지 않ㅇ므 -> 고가용성 관리는 혼합되어 있음
- 클라우드 공급자가 MySQL의 인프라 작업을 자동으로 관리해 주므로 본질적인 업무에 집중할 수 있도록 해줌
## 10.3 네트워크와 스토리지...지연시간
- 온-프레미스 환경에서 로컬 네트워크는 매우 빠르고 안정적임
- 하지만 클라우드는 전 세계적이며 광역 네트워크는 지연 시간이 길고 안정성이 낮음
  - 장거리 네트워크 지연시간은 빛의 속도에 따라 물리적으로 제한되고 중간 라우팅에 의해 악화됨
- 클라우드 공급자는 네트워크 연결 스토리지를 사용(책 범위를 넘어섬) -> 로컬 스토리지보다 훨씬 느리고 덜 안정적임
- 네트워크 연결 스토리지는 클라우드 환경에서의 대기 시간은 크게 문제가 되지 않음
## 10.4 성능은 곧 돈이다
- 성능은 클라우드 환경에서의 쿼리 응답 시간임
- 클라우드에서 MySQL을 사용할 때 예상치 못한 요금 청구를 피하기 위해 알아야할 3가지 중요한 사항
##### 기본 컴퓨팅의 각 레벨에 대해 가격이 2배
- 각 레벨의 리소스가 점진적으로 증가가 아닌 2배 증가 -> 2배 비용 발생
  - vCPU 2개, RAM 8GB -> vCPU 4개, RAM 16GB  
- 엔지니어링 관점에서는 확장은 매우 작은 컴퓨팅이지만 비용은 큰 이슈
##### 클라우드의 모든 것은 비용이 듬
- 컴퓨팅 비용 외 MySQL에 대해 다음 목록에 대해 비용이 듬
  - 스토리지 유형(IOPS)
  - 데이터 스토리지(크기)
  - 백업(크기와 보존 기간)
  - 로그(크기와 보존 기간)
  - 고가용성(복제본)
  - 리전 간 데이터 전송(크기)
  - 암호화 키(데이터 암호화용)
  - 비밀(비밀번호 저장용)
- 이러한 비용은 인스턴스 별로 부과됨
##### 클라우드 공급자가 할인을 제공한다는 것
- 클라우드 공급자가 할인을 제공함 -> 절대 제 값으로 비용을 치루지 말자
