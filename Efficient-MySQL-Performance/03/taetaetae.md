# 3장. 데이터
- 데이터의 크기가 성능에 영향을 미친다.

## 세 가지 비밀
- 인덱스가 항상 도움이 되지는 않는다터
  - 인덱스는 쿼리 성능을 향상시키는 데 매우 유용하지만, 모든 경우에 도움이 되지는 않음
  - 일부 쿼리는 이미 인덱스를 사용하더라도 여전히 느릴 수 있으며, 이 경우 간접적인 최적화 방법이 필요함
  - 인덱스가 효과적이지 않은 이유는 쿼리의 구조, 데이터의 분포, 인덱스 선택의 문제 등 다양하다.
- 데이터가 적을수록 좋다 
  - 저장된 데이터가 적을수록 쿼리 성능이 향상된다.
  - 불필요한 데이터를 삭제하거나 아카이브하여 데이터베이스의 크기를 줄이는 것이 중요하다. 
  - 데이터를 효율적으로 관리하면 디스크 I/O가 줄어들고 캐시 효율이 높아진다.
- 낮은 QPS(초당 쿼리 수)가 더 낫다.
  - 초당 쿼리 수(QPS)가 낮을수록 시스템의 부하가 줄어들어 성능이 개선된다.
  - 높은 QPS는 시스템 자원을 많이 사용하게 되어 전체적인 성능 저하를 초래할 수 있다. 
  - QPS를 낮추기 위해 쿼리 최적화, 캐싱, 배치 처리 등을 활용할 수 있다.

## 최소 데이터 원칙
- 데이터 접근
  - 필요한 데이터만 선택적으로 액세스해야 한다. 이는 쿼리의 효율성을 높이고 불필요한 데이터 액세스를 줄여 성능을 개선하는 데 중요하다. 
  - 예를 들어, 필요한 열만 선택하고 조건절을 통해 검색 범위를 좁히는 것이 좋다.
- 데이터 스토리지
  - 효율적인 데이터 저장소 사용을 통해 성능을 최적화할 수 있다. 이는 데이터베이스의 스키마 설계, 인덱스 최적화, 데이터 압축 등을 포함한다. 
  - 데이터베이스 설계를 최적화하면 디스크 공간을 절약하고 쿼리 성능을 향상시킬 수 있다.

## 데이터 삭제 또는 보관
- 도구
  - 데이터를 삭제하거나 아카이브할 때 사용할 수 있는 다양한 도구가 있다.
  - 이러한 도구들은 데이터를 안전하게 관리하고 성능에 미치는 영향을 최소화하는 데 도움을 줍니다.
- 배치 크기
  - 한 번에 처리하는 데이터의 양을 조절하여 시스템 성능을 최적화할 수 있다. 너무 큰 배치 작업은 시스템에 부담을 줄 수 있으므로 적절한 크기로 나누어 처리해야 한다.
  - 큰 데이터를 삭제하거나 업데이트할 때는 작업을 작은 단위로 나누어 처리함으로써 시스템 자원을 효율적으로 사용할 수 있다.
- 행 잠금 경합
  - 데이터 삭제나 업데이트 시 행 잠금이 발생할 수 있다. 경합을 최소화하고 성능 저하를 방지하기 위해 적절한 전략을 사용하는 것이 중요하다.
  - 행 잠금 경합을 줄이기 위해서는 트랜잭션을 짧게 유지하고, 가능한 한 적은 양의 데이터를 한 번에 처리해야 한다.
- 공간 및 시간
  - 데이터 저장과 관련된 공간 및 시간 문제 해결:
    - 데이터베이스의 크기가 커질수록 저장 공간과 처리 시간이 증가. 이를 해결하기 위해 데이터 압축, 파티셔닝, 인덱스 최적화 등의 방법을 사용
    - 데이터 압축은 디스크 공간을 절약하고 I/O 성능을 향상시킬 수 있다. 파티셔닝은 데이터를 논리적인 단위로 나누어 관리하고 쿼리 성능을 개선하는 데 도움이 된다.
  - 바이너리 로그 역설
    - 바이너리 로그는 데이터베이스의 변경 사항을 기록하는 데 사용되지만, 이로 인해 성능이 저하될 수 있다. 
    - 이진 로그의 크기를 관리하고 필요한 경우 로그를 정리하여 성능을 최적화할 수 있다.