# 4장. 접근패턴
## 4-1. MySQL Does Nothing (MySQL은 아무것도 하지 않는다)
- MySQL은 애플리케이션이 요청한 대로 쿼리를 실행하는 것 외에는 별다른 동작을 하지 않음.
- 성능 문제의 원인은 대부분 애플리케이션의 쿼리와 접근 방식에 있음.
- 초당 쿼리 수(QPS)와 CPU 사용률은 애플리케이션의 효율성을 반영함.
- 쿼리 경합은 시스템 성능을 저하시킬 수 있으며, 주로 쿼리 실행 빈도가 높을 때 발생함.

## 4-2. Performance Destabilizes at the Limit (성능은 한계에서 불안정해진다)
- MySQL 성능은 하드웨어 자원의 한계에 가까워질수록 불안정해짐.
- 시스템이 최대 용량의 80%~95%에 도달하면 성능이 급격히 떨어질 수 있음.
- 보편적 확장성 법칙에 따르면, 성능 한계를 넘어서면 시스템은 불안정해지고 성능이 저하됨.
- 실제 사례를 통해 쿼리 스레드가 불안정하게 실행되면서 성능이 급격히 저하되는 현상을 보여줌.

## 4-3. Toyota and Ferrari (도요타와 페라리)
- 도요타와 페라리의 성능 차이처럼 MySQL 성능도 애플리케이션의 활용 방식에 따라 달라질 수 있음.
- 페라리가 도요타보다 빠른 이유는 고속 주행을 목표로 세부적으로 설계되었기 때문임.
- MySQL에서도 최상의 성능을 얻기 위해서는 애플리케이션이 세부적으로 잘 설계되고 최적화되어야 함.

## 4-4. Data Access Patterns (데이터 접근 패턴)
- 읽기/쓰기 패턴 : 읽기와 쓰기 패턴은 데이터베이스 성능에 큰 영향을 미침. 예를 들어, 과도한 쓰기 작업은 데이터베이스의 I/O 성능을 저하시킬 수 있음. 
- 처리량 고려 : 높은 처리량을 요구하는 시스템에서는 적절한 인덱싱과 쿼리 최적화가 필수적임.
- 데이터 연령 및 접근 빈도 : 데이터의 나이와 접근 빈도에 따라 접근 패턴을 조정해야 함. 오래된 데이터는 덜 자주 접근되므로 더 느린 스토리지에 보관할 수 있음.
- 트랜잭션 격리 및 일관성 : 트랜잭션 격리 수준은 데이터 일관성을 유지하는 데 중요하지만 성능을 저하시킬 수 있음.
- 동시성 : 여러 쿼리가 동시에 실행될 때 이를 적절히 관리하지 않으면 시스템 성능이 저하될 수 있음.
- 행 접근 및 결과 집합 : 특정 행에 접근하는 방법과 쿼리가 반환하는 데이터의 크기와 내용은 성능에 큰 영향을 미침.

## 4-5. Application Changes (애플리케이션 변경)
- 코드 감사
  - 데이터베이스에 접근하는 모든 코드에 대해 정기적인 감사를 수행해야 함
  - 쿼리뿐만 아니라, 비즈니스 로직과 이를 달성하는 방법도 점검해야 함
  - 불필요하거나 비효율적인 쿼리를 찾아내고, 이를 제거하거나 최적화할 필요가 있음.
- 오프로드 읽기
  - MySQL의 기본 인스턴스는 모든 읽기와 쓰기 작업을 처리함. 
  - 성능을 개선하기 위해, 읽기 작업을 복제본 또는 캐시 서버로 분산시키는 것이 필요함.
- MySQL 복제본
  - 복제본을 사용하여 읽기 작업을 처리하면 성능을 향상시킬 수 있음. 
  - 복제본은 소스와 동일한 데이터를 유지하므로 고가용성을 보장하면서도 읽기 부하를 분산시킬 수 있음.
- 캐시 서버
  - 캐시 서버는 매우 빠르게 데이터를 제공할 수 있는 장점이 있음.
  - SQL, 트랜잭션, 내구성 저장소와 같은 오버헤드가 없기 때문에 성능 향상에 매우 효과적임.
  - 다만, 캐시 서버는 추가적인 관리 작업이 필요하고, 데이터 일관성 문제를 해결해야 함.
- 쓰기 대기열에 넣기
  - 쓰기 작업을 큐에 넣어 비동기적으로 처리함으로써 시스템 성능을 최적화하는 방법. 
  - 쓰기 작업이 갑작스럽게 증가하는 상황에서도 안정적인 처리량을 유지할 수 있도록 도움.
  - 예를 들어, 큐를 사용하여 쓰기 요청을 관리하면, MySQL이 갑작스러운 트래픽 증가를 처리하지 못해 발생할 수 있는 과부하 문제를 방지할 수 있음.
- 데이터 분할
  - 데이터를 물리적으로 분리하여 파티셔닝함으로써 성능을 개선하는 방법.
  - 특히 핫 데이터와 콜드 데이터를 분리하여 저장소 성능을 최적화할 수 있음.
    - 핫 데이터: 자주 접근되는 데이터를 빠른 스토리지에 저장하여 접근 속도를 높임.
    - 콜드 데이터: 드물게 접근되는 데이터를 느린 스토리지에 저장하여 자원을 효율적으로 사용함.
- MySQL을 사용하지 않기
  - 특정 애플리케이션에서는 MySQL이 최적의 선택이 아닐 수 있음. 
  - 이런 경우 MySQL 대신 NoSQL 데이터베이스나 다른 기술을 사용하는 것이 더 나을 수 있음.
  - MySQL이 모든 경우에 적합한 것은 아님을 인식하고, 필요에 따라 더 적합한 도구를 선택하는 것이 중요함.

## 4-6. Better, Faster Hardware? (더 나은, 더 빠른 하드웨어?)
- 하드웨어 업그레이드가 모든 성능 문제를 해결하지는 않음.
- 하드웨어 업그레이드는 일시적으로 성능을 개선할 수 있으나 근본적인 문제는 애플리케이션의 접근 패턴과 쿼리 구조에 있음.
- 하드웨어 업그레이드 시, 먼저 쿼리 최적화와 데이터베이스 구조 개선을 고려해야 함.