# 호텔 예약 시스템
> 에어비앤비, 항공권, 영화 티켓 예매 시스템과 같은 예약 시스템을 설계해보자

## 1단계: 문제 이해 및 설계 범위 확정
* 호텔 예약 시스템은 복잡하고 컴포넌트는 시스템을 사업에 어떻게 이용할지에 따라 달라진다.

* Q: 시스템 규모는 어느 정도입니까?
* A: 5000개 호텔 100만개 객실을 갖춘 호텔 체인이라고 가정합니다
* Q: 대금은 예약 시에 지불인가? 현장 결제인가?
* A: 예약할 때 지불한다
* Q: 휍사이트로만 가능한가?
* A: 웹 사이트나 앱에서만 가능
* Q: 취소할 수도 있는지?
* A: 물론이다
* Q: 고려할 다른 사항이 더 있는지?
* A: 10% 초과 예약이 가능해야 한다. 취소 고객을 얘상하여 실제보다 많은 객실 판매가 가능하다
* Q: 시간이 제한되어 있으므로 객실 검색은 범위에 넣지 않겠다. 아래 요구사항을 상정하고 진행하겠다
  * 호텔 정보 표시
  * 객실 정보 표시
  * 객실 얘약
  * 객실 정보를 추가/삭제/갱신하는 관리자 페이지 지원
  * 초과 예약 지원
* A: 객실 가격은 유동적이고 그날 객실의 여유가 얼마나 있는지에 따라 달라진다, 또한 매일 달라질 수 있다

### 비기능 요구사항
* 높은 수준의 동시성(concurrency) 지원: 성수기, 대규모 이벤트 기간에는 일부 인기 호텔의 예약이 몰릴 수 있다
* 적절한 지연 시간: 사용자가 예약할 때 응답이 빠를수록 좋으나 몇 초 정도는 괜찮다

### 개략적 규모 추정
* 5천개 호텔 100만 개의 객실이 있다고 가정하자
* 평균 이용률은 70%이고 평균 투숙 기간은 3일로 가정한다
* 하루에 70만개의 객실이 예약되지만 3일간 투숙하므로 233,333건의 애약이 발생한다
* 이는 약 3TPS 정도로 트래픽이 많지는 않다
* 그럼 각각의 페이지의 QPS를 계산해보자
1. 호텔/객실 상세 페이지
2. 예약 상세 정보 페이지
3. 객실 예약 페이지
* 대략 각 단계에서 10%만 진행한다고 가정하면
* 객실 상세 페이지 300TPS, 예약 상세 페이지 30TPS, 예약 페이지 3TPS가 된다

## 2단계: 개략적 설계안 제시 및 동의 구하기
### API 설계
* 호텔 API
* GET /v1/hotels/id : 호텔의 상세정보
* POST /v1/hotels : 신규 호텔 추가
* PUT /v1/hotels/id : 호텔 정보 갱신
* DELETE /v1/hotels/id : 호텔 정보 삭제

* 객실 관련 API
* GET /v1/hotels/:id/rooms/id : 객실의 상세정보
* POST /v1/hotels/:id/rooms : 객실 추가
* PUT /v1/hotels/:id/rooms/id : 객실 갱신
* DELETE /v1/hotels/:id/rooms/id : 객실 삭제

* 예약 관련 API
* GET /v1/reservations : 로그인 사용자의 예약 이력 반환
* GET /v1/reservations/id : 특정 예약의 상세 정보 반환
* POST /v1/reservations : 신규 예약
* DELETE /v1/reservations/id : 예약 취소

